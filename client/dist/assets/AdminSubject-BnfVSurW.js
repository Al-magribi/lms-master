import{ay as e,j as a,d as s,am as t,az as n}from"./index-DAvLbB94.js";import{b as l,u as r}from"./vendor-CnnDPxwB.js";import{L as i}from"./Layout-BDsu45_O.js";import{T as c}from"./Table-BVJYUMLF.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";const d=({detail:t,setDetail:n})=>{const[r,i]=l.useState(""),[c,d]=l.useState(""),[m,o]=l.useState(null),u=l.useRef(null),[x,{isSuccess:h,isLoading:p,isError:j,reset:g}]=e();return l.useEffect((()=>{t&&(i(t.id),d(t.name))}),[t]),l.useEffect((()=>{(h||j)&&(g(),n({}),i(""),d(""),u.current&&(u.current.value=null))}),[h,j]),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!c)return s.error("Lengkapi data");const a=new FormData;a.append("id",r||""),a.append("name",c),a.append("cover",m),s.promise(x(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"rounded border p-2 bg-white d-flex flex-column gap-2",children:[a.jsx("p",{className:"m-0 h6",children:"Mata Pelajaran"}),a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:c||"",onChange:e=>d(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:u,onChange:e=>o(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{n({}),i(""),d(""),u.current&&(u.current.value=null)},children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:p,children:"Simpan"})]})]})},m=({setDetail:e,homepage:i})=>{const d=r(),[m,o]=l.useState(1),[u,x]=l.useState(10),[h,p]=l.useState(""),{data:j={},isLoading:g}=t({page:m,limit:u,search:h}),{totalData:b,totalPages:N,subjects:f=[]}=j,[v,{isSuccess:y,isLoading:S,isError:w,reset:k}]=n();return l.useEffect((()=>{(y||w)&&k()}),[y,w]),a.jsx(c,{page:m,setPage:o,setLimit:x,setSearch:p,totalData:b,totalPages:N,isLoading:g,children:a.jsxs("table",{className:"table table-bordered table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-center",children:"No"}),a.jsx("th",{className:"text-center",children:"Cover"}),a.jsx("th",{className:"text-center",children:"Mata Pelajaran"}),a.jsx("th",{className:"text-center",children:"Guru Pengampu"}),a.jsx("th",{className:"text-center",children:"Aksi"})]})}),a.jsx("tbody",{children:(null==f?void 0:f.length)>0?null==f?void 0:f.map(((t,n)=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-center align-middle",children:(m-1)*u+n+1}),a.jsx("td",{className:"text-center align-middle",children:a.jsx("img",{src:t.cover?t.cover:null==i?void 0:i.icon,alt:`cover-${t.name}`,width:65,height:80,className:"overflow-hidden rounded",style:{objectFit:"cover"}})}),a.jsx("td",{className:"align-middle",children:t.name}),a.jsx("td",{className:"align-middle d-flex flex-column gap-2",children:t.teachers.map(((e,s)=>{var t,n;return a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("p",{className:"m-0",children:[e.name," ",a.jsx("span",{className:"text-secondary",children:`(${(null==(t=e.class)?void 0:t.length)>0?null==(n=e.class)?void 0:n.map((e=>e.name)).join(", "):"Data belum tersedia"})`})]}),a.jsxs("div",{className:"d-flex gap-2 text-secondary",children:[a.jsxs("p",{className:"m-0",children:[e.chapters," Chapter"]}),a.jsxs("p",{className:"m-0",children:[e.contents," Materi"]})]})]},s)}))}),a.jsx("td",{className:"text-cente align-middle",children:a.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");d(`/pelajaran/${s}/${a}`)})(t.name,t.id),children:a.jsx("i",{className:"bi bi-three-dots-vertical"})}),a.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(t),children:a.jsx("i",{className:"bi bi-pencil-square"})}),a.jsx("button",{className:"btn btn-sm btn-danger",disabled:S,onClick:()=>{return e=t.id,void(window.confirm("Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?")&&s.promise(v(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:a.jsx("i",{className:"bi bi-folder-minus"})})]})})]},n))):a.jsx("tr",{children:a.jsx("td",{colSpan:5,children:"Data tidak tersedia"})})})]})})},o=({homepage:e})=>{const[s,t]=l.useState({});return a.jsx(i,{title:"Mata Pelajaran",levels:["admin"],children:a.jsxs("div",{className:"row g-2",children:[a.jsx("div",{className:"col-lg-3 col-12",children:a.jsx(d,{detail:s,setDetail:t})}),a.jsx("div",{className:"col-lg-9 col-12",children:a.jsx(m,{setDetail:t,homepage:e})})]})})};export{o as default};
//# sourceMappingURL=AdminSubject-BnfVSurW.js.map
