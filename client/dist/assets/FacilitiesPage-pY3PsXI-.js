import{q as a,r as e,t as s,d as i,j as t,m as l}from"./index-DxiHux_d.js";import{b as n}from"./vendor-CnnDPxwB.js";import{L as d}from"./Layout-BWZgGjOq.js";import{C as r}from"./CmsModal-B3HsRj5W.js";import{C as c}from"./CmsForm-DuteKL6_.js";import{T as m}from"./Table-C87Jt7gp.js";import"./index-B8CuzAwO.js";const o=({homepage:o})=>{const[h,u]=n.useState(!1),[x,b]=n.useState("add"),[g,j]=n.useState(null),[p,N]=n.useState(1),[f,y]=n.useState(10),[v,F]=n.useState(""),[w,C]=n.useState(0),{data:S,isLoading:k,refetch:L}=a({page:p,limit:f,search:v}),{results:T,totalData:q,totalPage:G}=S||{},[P,{isSuccess:B,error:D,isLoading:A,data:E,reset:M}]=e(),[_]=s();n.useEffect((()=>{var a;B&&(i.success(E.message),u(!1),L(),j(null),C((a=>a+1)),M()),D&&(i.error(null==(a=D.data)?void 0:a.message),M())}),[B,D,E,M,L]);return t.jsxs(d,{title:"Fasilitas",levels:["cms"],children:[t.jsx("div",{className:"container-fluid py-3 py-md-4",children:t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("div",{className:"p-3 rounded me-3",style:{color:null==o?void 0:o.primary_color,backgroundColor:null==o?void 0:o.secondary_color},children:t.jsx("i",{className:"bi bi-building fs-4"})}),t.jsx("h4",{className:"mb-0",children:"Fasilitas"})]}),t.jsxs("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>{b("add"),j(null),u(!0)},children:[t.jsx("i",{className:"bi bi-plus-circle"}),t.jsx("span",{className:"ms-2",children:"Tambah Fasilitas"})]})]}),t.jsx("div",{className:"card border-0 shadow-sm",children:t.jsx("div",{className:"card-body",children:t.jsx(m,{isLoading:k,page:p,setPage:N,totalPages:G,limit:f,setLimit:y,setSearch:F,totalData:q,children:t.jsxs("table",{className:"mb-0 table table-bordered table-striped table-hover",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-center align-middle",children:"No"}),t.jsx("th",{className:"text-center align-middle",children:"Gambar"}),t.jsx("th",{className:"text-center align-middle",children:"Nama Fasilitas"}),t.jsx("th",{className:"text-center align-middle",children:"Aksi"})]})}),t.jsx("tbody",{children:null==T?void 0:T.map(((a,e)=>t.jsxs("tr",{children:[t.jsx("td",{className:"text-center align-middle",children:(p-1)*f+e+1}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("img",{src:a.image,alt:a.name,width:200,height:100,style:{objectFit:"cover"}})}),t.jsx("td",{className:"align-middle",children:a.name}),t.jsx("td",{className:"text-center align-middle",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[t.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>(a=>{b("edit"),j(a),u(!0)})(a),children:t.jsx("i",{className:"bi bi-pencil-square"})}),t.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>(async a=>{var e;if(window.confirm("Apakah anda yakin ingin menghapus fasilitas ini?"))try{await _(a).unwrap(),i.success("Fasilitas berhasil dihapus"),L()}catch(s){i.error((null==(e=s.data)?void 0:e.message)||"Gagal menghapus fasilitas")}})(a.id),children:t.jsx("i",{className:"bi bi-trash"})})]})})]},a.id)))})]})})})})]})}),t.jsx(r,{isOpen:h,onClose:()=>{u(!1),j(null),C((a=>a+1))},title:"add"===x?"Tambah Fasilitas":"Edit Fasilitas",children:t.jsx(c,{fields:[{name:"name",label:"Nama Fasilitas",type:"text",required:!0,placeholder:"Masukkan nama fasilitas"},{name:"image",label:"Gambar",type:"file",required:!0,placeholder:"Pilih gambar fasilitas",accept:"image/*"}],initialValues:g||{name:"",image:""},onSubmit:async a=>{var e;try{const e=new FormData;e.append("name",a.name),a.image instanceof File?e.append("image",a.image):(null==g?void 0:g.image)&&e.append("image",g.image),(null==g?void 0:g.id)&&e.append("id",g.id),await P(e).unwrap()}catch(s){console.log(s),i.error((null==(e=s.data)?void 0:e.message)||"Gagal menyimpan fasilitas")}},onCancel:()=>{j(null),u(!1),C((a=>a+1))},submitButtonText:"add"===x?"Tambah Fasilitas":"Ubah Fasilitas",cancelButtonText:"Batal",isLoading:A},w)})]})};export{o as default};
//# sourceMappingURL=FacilitiesPage-pY3PsXI-.js.map
