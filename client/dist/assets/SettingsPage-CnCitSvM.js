import{D as e,E as a,j as n,m as l,d as s}from"./index-DAvLbB94.js";import{b as t}from"./vendor-CnnDPxwB.js";import{L as i}from"./Layout-Dl4dmZvm.js";import{C as r}from"./CmsForm-CV9EwIBO.js";import{v as c,w as o,x as d}from"./index-B8CuzAwO.js";const m=()=>{const[m,p]=t.useState(null),[x,u]=t.useState(!0),[g,h]=t.useState(null),[f,b]=t.useState(null),[j,v]=t.useState(null),[y,N]=t.useState(null),[w,k]=t.useState(null),[L,S]=t.useState(null),[U,C]=t.useState("#0d6efd"),[R,_]=t.useState("#cfe2ff"),{data:F,isLoading:I,refetch:P,error:E}=e(),[O,{isLoading:B,isSuccess:D,isError:M,error:W,reset:T,data:$}]=a();t.useEffect((()=>{F&&(p(F),h(F.logo),v(F.icon),k(F.banner),C(F.primary_color||"#0d6efd"),_(F.secondary_color||"#cfe2ff"),u(!1))}),[F]);const q=async e=>{const a=(e=>{const a=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),l=parseInt(e.slice(5,7),16),s=.85,t=Math.round(a*(1-s)+216.75),i=Math.round(n*(1-s)+216.75),r=Math.round(l*(1-s)+216.75);return`#${t.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}`})(e);if(m)try{const n=new FormData;Object.entries({...m,primary_color:e,secondary_color:a}).forEach((([e,a])=>{"logo"!==e&&"icon"!==e&&"banner"!==e&&n.append(e,a)})),f?n.append("logo",f):m.logo&&n.append("logo",m.logo),y?n.append("icon",y):m.icon&&n.append("icon",m.icon),L?n.append("banner",L):m.banner&&n.append("banner",m.banner),await O(n).unwrap(),s.success("Warna berhasil diperbarui!")}catch(n){s.error("Gagal memperbarui warna")}};t.useEffect((()=>{D&&(T(),P(),window.location.reload(),b(null),N(null),S(null)),M&&T()}),[D,M,$,W,P,T]),t.useEffect((()=>()=>{j&&URL.revokeObjectURL(j),g&&URL.revokeObjectURL(g),w&&URL.revokeObjectURL(w)}),[]);return n.jsx(i,{title:"Pengaturan",levels:["cms"],children:n.jsx("div",{className:"container-fluid py-3 py-md-4",children:n.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[n.jsxs("div",{className:"d-flex align-items-center mb-4",children:[n.jsx("div",{style:{backgroundColor:null==F?void 0:F.secondary_color,color:null==F?void 0:F.primary_color},className:" p-3 rounded me-3",children:n.jsx(c,{className:"fs-4"})}),n.jsx("h4",{className:"mb-0",children:"Pengaturan"})]}),n.jsx("div",{className:"card border-0 shadow-sm",children:n.jsxs("div",{className:"card-body",children:[x||I||B?n.jsxs("div",{className:"text-center py-5",children:[n.jsx("div",{className:"spinner-border text-primary",role:"status",children:n.jsx("span",{className:"visually-hidden",children:"Loading..."})}),n.jsx("p",{className:"mt-2",children:"Loading settings..."})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"d-flex flex-wrap gap-4 mb-4",children:[n.jsxs("div",{className:"flex-grow-1 min-width-300",children:[n.jsx("label",{className:"form-label fw-bold mb-3",children:"Icon Website"}),n.jsxs("div",{className:"d-flex flex-column gap-3",children:[n.jsxs("div",{className:"image-preview-container bg-light rounded p-3 text-center",children:[j?n.jsx("img",{src:j,alt:"Icon preview",style:{width:"80px",height:"80px",objectFit:"contain"},className:"mb-3"}):n.jsx("div",{className:"placeholder-image mb-3",children:n.jsx(c,{className:"fs-1 text-secondary"})}),n.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){N(a);const e=URL.createObjectURL(a);v(e)}}})]}),n.jsx("small",{className:"text-muted",children:"Unggah icon website dengan ukuran yang disarankan 32x32 pixel"})]})]}),n.jsxs("div",{className:"flex-grow-1 min-width-300",children:[n.jsx("label",{className:"form-label fw-bold mb-3",children:"Logo Website"}),n.jsxs("div",{className:"d-flex flex-column gap-3",children:[n.jsxs("div",{className:"image-preview-container bg-light rounded p-3 text-center",children:[g?n.jsx("img",{src:g,alt:"Logo preview",style:{height:"100px",maxWidth:"300px",objectFit:"contain"},className:"mb-3"}):n.jsx("div",{className:"placeholder-image mb-3",children:n.jsx(c,{className:"fs-1 text-secondary"})}),n.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){b(a);const e=URL.createObjectURL(a);h(e)}}})]}),n.jsx("small",{className:"text-muted",children:"Unggah logo website dengan ukuran yang disarankan 200x50 pixel"})]})]}),n.jsxs("div",{className:"flex-grow-1 min-width-300",children:[n.jsx("label",{className:"form-label fw-bold mb-3",children:"Banner Website"}),n.jsxs("div",{className:"d-flex flex-column gap-3",children:[n.jsxs("div",{className:"image-preview-container bg-light rounded p-3 text-center",children:[w?n.jsx("img",{src:w,alt:"Banner preview",style:{width:"100%",height:"150px",objectFit:"cover"},className:"mb-3"}):n.jsx("div",{className:"placeholder-image mb-3",children:n.jsx(c,{className:"fs-1 text-secondary"})}),n.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){S(a);const e=URL.createObjectURL(a);k(e)}}})]}),n.jsx("small",{className:"text-muted",children:"Unggah banner website dengan ukuran yang disarankan 1920x400 pixel"})]})]})]}),n.jsx("style",{jsx:!0,children:"\n                    .min-width-300 {\n                      min-width: 300px;\n                    }\n                    .image-preview-container {\n                      min-height: 200px;\n                      display: flex;\n                      flex-direction: column;\n                      justify-content: center;\n                      align-items: center;\n                    }\n                    .placeholder-image {\n                      width: 80px;\n                      height: 80px;\n                      display: flex;\n                      align-items: center;\n                      justify-content: center;\n                      color: #6c757d;\n                    }\n                  "}),n.jsx(r,{fields:[{name:"name",label:"Site Name",type:"text",required:!0},{name:"tagline",label:"Tagline",type:"text",required:!0},{name:"description",label:"Description",type:"textarea",required:!0},{name:"video_url",label:"Video URL",type:"text"},{name:"youtube",label:"YouTube",type:"text"},{name:"instagram",label:"Instagram",type:"text"},{name:"facebook",label:"Facebook",type:"text"},{name:"ppdb_url",label:"PPDB URL",type:"text"},{name:"address",label:"Alamat",type:"text"},{name:"title_reason",label:"Judul Alasan",type:"text"},{name:"desc_reason",label:"Deskripsi Alasan",type:"textarea"},{name:"title_facility",label:"Judul Fasilitas",type:"text"},{name:"desc_facility",label:"Deskripsi Fasilitas",type:"textarea"}],initialValues:m,onSubmit:async e=>{var a;try{const a=new FormData,n={...e,primary_color:U,secondary_color:R};Object.keys(n).forEach((e=>{["icon","logo","banner"].includes(e)||a.append(e,n[e])})),y?a.append("icon",y):(null==m?void 0:m.icon)&&a.append("icon",m.icon),f?a.append("logo",f):(null==m?void 0:m.logo)&&a.append("logo",m.logo),L?a.append("banner",L):(null==m?void 0:m.banner)&&a.append("banner",m.banner);const l=2097152,t=[{file:y,name:"Icon"},{file:f,name:"Logo"},{file:L,name:"Banner"}];for(const{file:e,name:i}of t)if(e&&e.size>l)return void s.error(`Ukuran file ${i} terlalu besar. Maksimal 2MB`);await s.promise(O(a).unwrap(),{loading:"Menyimpan pengaturan...",success:e=>(N(null),b(null),S(null),"Pengaturan berhasil disimpan"),error:e=>{var a;return console.error("Error details:",e),(null==(a=e.data)?void 0:a.message)||"Gagal menyimpan pengaturan"}}),P()}catch(n){console.error("Error in handleSubmit:",n),s.error((null==(a=n.data)?void 0:a.message)||"Terjadi kesalahan saat menyimpan pengaturan")}},submitButtonText:"Simpan",submitButtonIcon:n.jsx(o,{className:"me-2"})})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("h4",{children:"Pengaturan Warna"}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[n.jsx("label",{className:"form-label mb-0",children:"Primary Color"}),n.jsx("div",{className:"d-flex align-items-center gap-2",children:n.jsx("div",{className:"rounded-circle",style:{backgroundColor:R,width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #dee2e6"},children:n.jsx(d,{style:{color:U},className:"fs-4"})})})]}),n.jsx("div",{className:"d-flex flex-wrap gap-2",children:[{name:"Blue",value:"#0d6efd",light:"#cfe2ff"},{name:"Indigo",value:"#6610f2",light:"#e0cffc"},{name:"Purple",value:"#6f42c1",light:"#e2d9f3"},{name:"Pink",value:"#d63384",light:"#f7d6e6"},{name:"Red",value:"#dc3545",light:"#f8d7da"},{name:"Orange",value:"#fd7e14",light:"#ffe5d0"},{name:"Yellow",value:"#ffc107",light:"#fff3cd"},{name:"Green",value:"#198754",light:"#d1e7dd"},{name:"Teal",value:"#20c997",light:"#d2f4ea"},{name:"Cyan",value:"#0dcaf0",light:"#cff4fc"}].map((e=>n.jsx("div",{className:"rounded-circle",style:{backgroundColor:e.value,width:"30px",height:"30px",border:"2px solid #dee2e6",cursor:"pointer"},onClick:()=>q(e.value),title:e.name},e.name)))}),n.jsx("div",{className:"mt-3",children:n.jsx("input",{type:"color",className:"form-control form-control-color",value:U,onChange:e=>q(e.target.value),title:"Choose your color"})}),n.jsx("div",{className:"mt-3",children:n.jsxs("small",{className:"text-muted",children:["Selected Colors:",n.jsxs("div",{className:"d-flex gap-2 mt-1",children:[n.jsxs("div",{className:"d-flex align-items-center",children:[n.jsx("div",{className:"rounded-circle me-1",style:{backgroundColor:U,width:"20px",height:"20px",border:"1px solid #dee2e6"}}),"Primary: ",U]}),n.jsxs("div",{className:"d-flex align-items-center",children:[n.jsx("div",{className:"rounded-circle me-1",style:{backgroundColor:R,width:"20px",height:"20px",border:"1px solid #dee2e6"}}),"Secondary: ",R]})]})]})})]})]})]})})]})})})};export{m as default};
//# sourceMappingURL=SettingsPage-CnCitSvM.js.map
